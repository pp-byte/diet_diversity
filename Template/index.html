<!DOCTYPE html>
<html lang="en">
{% load crispy_forms_tags %}
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width-device-width", initial-scale="1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>RECIPE FORM</title>
    <link type="text/css" href="{% static 'cs/serial.css' %}" rel="stylesheet">
    <link type="text/css" href="{% static 'css/img.css' %}" rel="stylesheet">
    <link type="text/css" href="{% static 'css/style.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<script>
    var table
    $(document).ready(function(){
        $(".add-row").click(function(){
            var SrNo = $("#SrNo").val();
            var recipe_name = $("#id_recipe_name").val();
            var daily_freq= $("#id_daily_freq").val();
            var weekly_freq = $("#id_weekly_freq").val();
            var monthly_freq = $("#id_monthly_freq").val();
            var quan = $("#id_quan").val();
            var unit = $("#id_unit").val();
            var consistency = $("#id_consistency").val();
            var remark = $("#id_remark").val();
            var Frequencys = "<tr><td></td><td>" + recipe_name + "</td><td>" + daily_freq + "</td><td>" + weekly_freq + "</td><td>" + monthly_freq  + "</td><td>" + quan + "</td><td>" + unit +"</td><td>" + consistency +"</td><td>" + remark + "</td><td><input type='checkbox' name='record'></td></tr>";
            $("table tbody").append(Frequencys);
        });
        

        // Find and remove selected table rows
        $(".delete-row").click(function(){
            $("table tbody").find('input[name="record"]').each(function(){
                if($(this).is(":checked")){
                    $(this).parents("tr").remove();
                }
            });

        });

        $(".add").click(function(){
        var l;
            $("table tbody").find('input[name="record"]').each(function(){
                if($(this).is(":checked")){
                    l=$(this).parents("tr")
                    console.log(l)
                }
            });

        });

    });


    {% comment %} $(document).ready(function() {
        $('#tables').DataTable( {
           dom: 'Bfrtip',
           buttons: [
               {
           extend: 'csv',
           title: "Download",
           exportOptions: {
              columns: ":not(.not-export-column)"
           }
           }]
        } );
 } ); {% endcomment %}



<!--      $(function() {-->
<!--      $( "#Frequency_Day").datepicker({ dateFormat: 'dd.mm.yy' });-->
<!--      $("#Frequency_Month").datepicker({ dateFormat: 'dd.mm.yy'});-->

<!--});-->
</script>

                     <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">
     </script>
    <script>


             $(function(){
                $("#id_op").text("hi")
                $("#id_dob").on('change', function(){

                 console.log(dob,today,age);
                    })

              });

           var l=[]
           $(".add").click(function(){
            $("#id_op").value("hi")
            $("table tbody").find('input[name="record"]').each(function(){
                if($(this).is(":checked")){
                    l.append(this)
                }


            });


        });
    </script>
<style>
{% comment %} .table {
    border-collapse: collapse;
    margin:25px 0;
    font-size: 0.9em;
    min-width: 400px;
}
.table th,
.table td{
    padding:12px 12px;
}

.display_table{
	border-bottom-right-radius: 20px;
	border-bottom-left-radius: 20px;
	padding-left: 5px;
	padding-right: 5px;
	padding-bottom: 20px;
	box-shadow: 12px 12px 20px 6px #2e6da4;
} {% endcomment %}


.table{
	font-size: 13px;
	text-align: center;
	width: 95%;
	margin: auto;
	text-align: center;
	border: 0;
    border-spacing: 0;
    border-collapse: collapse;
    {% comment %} table-layout: fixed; {% endcomment %}
} 
th {
	padding: 12px;
  }
  caption {
	color: #002B7F;
	font-weight: bold;
  }
  caption,
  th {
	text-align: center;
  }
  thead {
	background-color: #007C66;
	color: white;
  }

/*Make alternating colors for the table rows*/
.table tr:nth-child(odd){
	background: #B8CAE4
}
.table tr:nth-child(even){
	background: #dae5f4
}

th {
  background-color: #337ab7;
  color: white;
}
.display_table{
	border-bottom-right-radius: 20px;
	border-bottom-left-radius: 20px;
	padding-left: 5px;
	padding-right: 5px;
	padding-bottom: 20px;
	box-shadow: 12px 12px 20px 6px #2e6da4;
}

</style>
  </head>
<body>

<div class="container">
        <div class="col-md-10 offset-md-1 mt-5">
            <div class="jumbotron">
                {% comment %} <h2 class="display-4" style="text-align: center; color: #4CAF50;">RECIPE FORM</h2> {% endcomment %}
                <h2 class="heading" style="text-align: center; color: #4CAF50;"><b>RECIPE FORM </b></h2>
                <!--p class="lead font-italic">Base data entry</p-->
                <hr class="my-4">
                {% block content %}
                  <form action="{% url 'index' %}" method="POST" >
                    {% csrf_token %}
                      {% comment %} <table>{{ form|crispy }} {% endcomment %}
                      {{ form|crispy }}
                      {% comment %} {{ form.recipe_name|as_crispy_field }}
                      {{ form.daily_freq|as_crispy_field }}
                      {{ form.weekly_freq|as_crispy_field }}
                      {{ form.monthly_freq|as_crispy_field }}
                      {{ form.quan|as_crispy_field }}
                      {{ form.unit|as_crispy_field }}
                      {{ form.remark|as_crispy_field }} 
                      {{ form.consistency|as_crispy_field }} {% endcomment %}
                      {% comment %} </table> {% endcomment %}
                      <input type="button" class="add-row" value="Add Item" style=" background-color: #4682B4;">
                      {% comment %} <input type="button" class="add-new-recipe" value="Add New Recipe"> {% endcomment %}
                      {% comment %} <option value="{{ widget.value|stringformat:'s' }}"{% include "django/forms/widgets/attrs.html" %}> {% endcomment %}
                        {% comment %} <button class="login-btn btn-large waves-effect waves-dark" style="width: 180px; background-color: #4CAF50;"><a href="/index" style="font-size: 14; color:#0645AD;"> Login</a></button> {% endcomment %}
                        {% comment %} <button class="add-new" type="button" id="new" name="add-item" value="Add New Recipe"><a href="/new_recipe" style="font-size: 14; color:#000000;">Add New Recipe</button> {% endcomment %}
                     <button class="add-new-recipe" type="button" id="new" name="add-item" value="Add New Recipe" style=" background-color: #4682B4;"><a href="/new_recipe" style="font-size: 14; color:#000000;">Add New Recipe</a></button> 
                        {% comment %} <button class="submit" type="submit" id="submit" name="submit" value="submit" style=" background-color: #4CAF50;"><a href="/new_recipe" style="font-size: 14; color:#000000;">Add New Recipe</a></button> {% endcomment %}
                      {% comment %} <button type="button" onclick="tableToCSV()"> download CSV</button> {% endcomment %}
                  {% comment %} </form> {% endcomment %}


                {% endblock content %}
            </div>
        </div>

<table class="table">
<thead>
    <tr>
      <th >SrNo</th>
      <th>Recipe_List</th>
      <th>Frequency(Days)</th>
      <th>Frequency(Weeks)</th>
      <th>Frequency(Month)</th>
      <th>Unit</th>
      <th>Number</th>
      <th>Consistency</th>
      <th>Remark/Comments</th>
      <th>Select</th>
    </tr>
</thead>
<tbody>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><input type="checkbox" name="record"></td>
     {% comment %} <td class="not-export-column"><input type="checkbox" name="record"></td> {% endcomment %}
    </tr>
</tbody>
</table>
<input type="Submit" class="Submit" id="myBtn" value="Submit" style=" background-color: #4682B4;">
</form>
<!--    <div class="display_table">-->
<!--      <table>-->
<!--      </table>-->
<!--</div>-->
 
<button type="button" class="delete-row" style=" background-color: #4682B4;">Delete Row</button>
{% comment %} <input type="Submit" class="Submit" id="submit" value="submit" name="submit" style=" background-color: #4CAF50;"> {% endcomment %}
{% comment %} <button class="btn-small" type="submit" name="action" style=" background-color: #4CAF50;">Submit</button> {% endcomment %}
{% comment %} <button type="button" class="add"  style=" background-color: #4CAF50;">Submit Table</button> {% endcomment %}
{% comment %} <button type="button" onclick="tableToCSV()"> download CSV</button> {% endcomment %}
<!--<script src="{% static 'javascript/tables.js' %}" type="text/javascript"></script>-->
    {% comment %} </div> {% endcomment %}


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>



    {% comment %} <script type="text/javascript">
        function tableToCSV() {
 
            // Variable to store the final csv data
            var csv_data = [];
 
            // Get each row data
            var rows = document.getElementsByTagName('tr');
            for (var i = 0; i < rows.length; i++) {
                var cols = rows[i].querySelectorAll('td,th');
                var csvrow = [];
                for (var j = 0; j< cols.length; j++) {
                    csvrow.push(cols[j].innerHTML);
                }
                csv_data.push(csvrow.join(","));
            }
            csv_data = csv_data.join('\n'); 
            downloadCSVFile(csv_data);
        }
        function downloadCSVFile(csv_data) {
            CSVFile = new Blob([csv_data], {
                type: "text/csv"
            });
            var temp_link = document.createElement('a');
            temp_link.download = "download.csv";
            var url = window.URL.createObjectURL(CSVFile);
            temp_link.href = url;
            temp_link.style.display = "none";
            document.body.appendChild(temp_link);
            //document.body.removeChild(td:last-child, th:last-child); 
            temp_link.click();
            document.body.removeChild(temp_link); 
        }
        {% comment %} function downloadCSVFile(csv_data){
            var clonetable = document.clone();
            clonetable.find('td:last-child, th:last-child').remove();
            download_table_as_csv(clonetable); {% endcomment %}

    {% comment %} </script>  {% endcomment %}
</body>
</html>

